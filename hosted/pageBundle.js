(()=>{var e={264:(e,t,a)=>{const n=a(802),l=e=>{const[t,a]=React.useState(e.players),[n,l]=React.useState(e.displayMode);React.useEffect((async()=>{if(1===n){const e=await fetch("/getPlayers"),t=await e.json();a(t)}}),[n]);const c=()=>{l(0==n?1:0)};if(!n||0===n)return React.createElement("button",{id:"playerDisplayBtn",onClick:e=>{c()}}," O -|- /\\");if(!t||0===t.length)return React.createElement("div",{id:"playerDisplayList"},React.createElement("button",{id:"closeWidgetBtn",onClick:c},"X"),React.createElement("h2",null,"No Players Yet..."));const s=t.map((e=>React.createElement("tr",{key:e.username},React.createElement("td",null,e.username),React.createElement("td",{className:"colorText",style:{backgroundColor:e.color}}))));return React.createElement("div",{id:"playerDisplayList"},React.createElement("button",{id:"closeWidgetBtn",onClick:c},"X"),React.createElement("table",null,React.createElement("caption",null,React.createElement("h3",null,React.createElement("u",null,"Current Players"))),React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Username"),React.createElement("th",null,"Color"))),React.createElement("tbody",null,s)))},c=e=>React.createElement("div",{className:"center"},React.createElement("h3",null,"Items"),React.createElement("img",{id:"screwattack",src:"assets/img/screwattack.png",style:{display:"none"},width:"16",height:"16",alt:"Infinite Flip Powerup"}),React.createElement("img",{id:"morphball",src:"assets/img/morphball.png",style:{display:"none"},width:"16",height:"16",alt:"Shrinking Powerup"}),React.createElement("img",{id:"yellowswitch",src:"assets/img/yellowswitch.png",style:{display:"none"},width:"32",height:"32",alt:"Final Powerup"}),React.createElement("div",{className:"center",id:"instructions"},React.createElement("div",{id:"moveInstructions",className:"inline"},"Use '",React.createElement("strong",null,"A"),"' and '",React.createElement("strong",null,"D"),"' to move, "),React.createElement("div",{id:"spaceInstructions",className:"inline"}," ",React.createElement("strong",null," SPACE")," to flip.")),React.createElement("button",{id:"resetBtn",disabled:!0},"Back to Start")),s=e=>{const[t,a]=React.useState(e.displayMode);return React.useEffect((async()=>{a(e.displayMode)}),[e]),0===t?null:React.createElement("form",{id:"changePasswordForm",name:"changePasswordForm",className:"inputForm"},React.createElement("div",{className:"floatLeft"},React.createElement("label",{htmlFor:"oldPass"},"Payment Example: "),React.createElement("input",{id:"oldPass",type:"text",name:"oldPass",placeholder:"Payment Info"})),React.createElement("div",{className:"floatRight"},React.createElement("label",{htmlFor:"newPass"},"Payment Example: "),React.createElement("input",{id:"newPass",type:"text",name:"newPass",placeholder:"Payment Info"})),React.createElement("button",{type:"button",id:"closeForm",onClick:e=>{a(0)}},"Close Form"),React.createElement("input",{className:"formSubmit",id:"changePasswordSubmit",type:"submit",disabled:!0,value:"Purchase (Demo)"}))},r=async e=>{const t={shape:e,_csrf:document.getElementById("_csrf").value};ReactDOM.render(React.createElement(s,{displayMode:2}),document.getElementById("formContent")),await fetch("/setShape",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),n.setShape(e)},o=e=>{const[t,a]=React.useState(e.displayMode),[n,l]=React.useState(e.disabled),[c,s]=React.useState(e.selected);React.useEffect((async()=>{l(e.disabled),s(e.selected)}),[e]);const o=()=>{a(0===t?1:0)};if(!t||0===t)return React.createElement("button",{disabled:n,id:"payModelBtn",onClick:o},"∇ ▢ ◇");const d=()=>React.createElement("table",{id:"payModelTable"},React.createElement("caption",null,React.createElement("h3",null,React.createElement("u",null,"Shape Shop"))),React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Shape"),React.createElement("th",null,"Price"))),React.createElement("tbody",null,React.createElement("tr",{className:0==c?"selected":"",onClick:e=>{s(0),r(0)}},React.createElement("td",null,"Circle"),React.createElement("td",null,React.createElement("em",null,"$ Free "))),React.createElement("tr",{className:1==c?"selected":"",onClick:e=>{s(1),r(1)}},React.createElement("td",null,React.createElement("strong",null,"Big")),React.createElement("td",null,React.createElement("em",null,"$ Free "))),React.createElement("tr",{className:2==c?"selected":"",onClick:e=>{s(2),r(2)}},React.createElement("td",null,"Tiny"),React.createElement("td",null,React.createElement("em",null,"$ Free "))),React.createElement("tr",{className:3==c?"selected":"",onClick:e=>{s(3),r(3)}},React.createElement("td",null,"Spider"),React.createElement("td",null,React.createElement("em",null,"$ Free "))),React.createElement("tr",{className:4==c?"selected":"",onClick:e=>{s(4),r(4)}},React.createElement("td",null,React.createElement("em",null,"Handsome")),React.createElement("td",null,React.createElement("em",null,"$ Free ")))));return React.createElement("div",{id:"payModelDisplay"},React.createElement("button",{id:"closeWidgetBtn",onClick:o},"X"),React.createElement(d,null))};e.exports={PlayerDisplay:l,GameInfo:c,PayModelDisplay:o,init:()=>{ReactDOM.render(React.createElement(c,null),document.getElementById("gameInfo")),ReactDOM.render(React.createElement(l,{players:[],displayMode:0}),document.getElementById("playerDisplay")),ReactDOM.render(React.createElement(o,{displayMode:0,disabled:!0,selected:0}),document.getElementById("payModel"))}}},603:e=>{const t=e=>{document.getElementById("createResponse").textContent=e};e.exports={handleError:t,sendPost:async(e,a,n)=>{const l=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),c=await l.json();if(document.getElementById("createResponse").textContent="",c.error)return t(c.error);c.message&&(document.getElementById("createResponse").textContent=c.message),c.redirect&&(window.location=c.redirect),n&&n(c)},hideError:()=>{document.getElementById("createResponse").textContent=""}}},689:(e,t,a)=>{"use strict";a.r(t),a.d(t,{bgRect:()=>n,clouds:()=>s,getData:()=>r,rects:()=>l,specialObjects:()=>c});class n{constructor(e,t,a,n,l){this.x=e,this.y=t,this.width=a,this.height=n,this.color=l,this.hSpeed=n*a/15,this.vSpeed=0}}let l=[],c=[],s=[];const r=async()=>{let e=await fetch("/getLevel",{method:"GET",headers:{Accept:"application/json"}});const t=await e.json();t.level&&t.level.rects&&t.level.specialObjects&&(l=t.level.rects,c=t.level.specialObjects),t.level.clouds&&t.level.clouds.length>0&&(s=[...t.level.clouds])}},802:(e,t,a)=>{"use strict";a.r(t),a.d(t,{init:()=>A,setShape:()=>Q});const n=(e,t,a,n,l,c,s=!0,r=0)=>{switch(n&&(l*=-1),s&&a.clearRect(0,0,640,480),a.save(),a.beginPath(),r){case 0:default:a.arc(e,t-3*l,3,0,2*Math.PI);break;case 1:l*=2,a.arc(e,t-3*l,Math.abs(3*l),0,2*Math.PI);break;case 2:l*=.5,a.arc(e,t-3*l,Math.abs(3*l),0,2*Math.PI);break;case 3:a.rect(e,t,5*l,5*l);break;case 4:a.rect(e-3*l,t-6*l,6*l,6*l)}a.moveTo(e,t),a.lineTo(e,t+5*l),a.lineTo(e-2*l,t+8*l),a.moveTo(e,t+5*l),a.lineTo(e+2*l,t+8*l),a.moveTo(e-3*l,t+3*l),a.lineTo(e+3*l,t+3*l),c&&(a.strokeStyle=c),a.stroke(),a.closePath(),a.restore()},l=(e,t,a,n,l,c,s)=>{l.save(),l.beginPath(),l.moveTo(e,t),l.lineTo(e+a,t),l.lineTo(e+a,t+n),l.lineTo(e,t+n),l.closePath(),s?(l.fillStyle=c,l.fill()):(l.strokeStyle=c,l.lineWidth=3,l.stroke()),l.restore()},c=(e,t)=>Math.random()*(t-e)+e;var s=a(689);const r=async(e,t)=>{const a={username:e,item:t,_csrf:document.querySelector("#_csrf").value};await fetch("/updateItems",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})};let o,d,i;const m=[];let u={},p={},h=0;const y={},E={screwattack:{obtained:!1,collected:ee},morphball:{obtained:!1,collected:Z},yellowswitch:{collected:ae},fire:{collected:Z}},g={x:-450,y:690,halfWidth:4,halfHeight:7,newX:300,newY:300,scale:1,name:"",flip:!1};let f,R,w,v,b,P,S,k,I=0,M=0,x=!0,B=!1,C=!1,O=!0,T=!1,F=!1,N=0,D=[],L=0;const j=640,_=480;let q=0,W=0;const A=(e,t=!1)=>{e&&e.username&&e.items&&e.color&&e.shape>=0&&(g.name=e.username,I=e.color,g.shape=e.shape,e.items&&K(e.items),ne()),u.name=g.name,u.color=I,u.movement=[],w=new Audio("assets/sound/buttonClick.wav"),w.volume=.25,v=new Audio("assets/sound/itemGet.wav"),v.volume=.25,v=new Audio("assets/sound/itemGet.wav"),v.volume=.25,k=new Audio("assets/sound/explosion.wav"),k.volume=.25,b=new Audio("assets/sound/the-earth.mp3"),b.volume=.25,P=new Audio("assets/sound/warp-whistle.mp3"),P.volume=.3,S=new Audio("assets/sound/world-sky.mp3"),S.volume=.25,t?document.addEventListener("click",(e=>{b.play(),b.loop=!0}),{once:!0}):(b.play(),b.loop=!0);let a=document.querySelector("#canvas_player"),l=document.querySelector("#canvas_walkers"),c=document.querySelector("#canvas_bg");document.getElementById("resetBtn").onclick=te,o=l.getContext("2d"),d=a.getContext("2d"),i=c.getContext("2d"),f=l.width,R=l.height,document.addEventListener("keydown",le),document.addEventListener("keyup",ce),n(300,300,d,!1),s.clouds&&s.clouds.length>0&&s.clouds.forEach((e=>{m.push(new s.bgRect(630*Math.random()+5,470*Math.random()+5,10*Math.random()+30,4*Math.random()+3,e))}));for(let e=0;e<10;e++)m.push(new s.bgRect(Math.random()*j,Math.random()*_,10*Math.random()+30,4*Math.random()+3,"rgba(0,0,0,0.3)"));Y(),o.fillStyle="black",g.x=g.y=300,setInterval($,1e3/60),setInterval(Y,1e3/15),setInterval(U,1e3),setInterval(G,1e3/30)},$=()=>{!C&&O?(H(),n(g.x+q,g.y+W,d,g.flip,g.scale,g.color,void 0,g.shape)):C&&ae(),X()},H=()=>{let e=0,t=0;D[65]&&(e=-3),D[68]&&(e=3),t=g.flip?-5:5,T?D[87]&&(W-=((e,t)=>{let a=4,n=0;return t&&(a=-4),1===e.scale?(e.scale=.1,e.halfWidth=1,e.halfHeight=1,n=-a):(e.scale=1,e.halfWidth=4,e.halfHeight=7,n=-3*a),e.y+=n,n})(g,g.flip),T=!1,N=30,e=0,t=0):F&&(N-=1,N<=0&&(T=!0)),g.newX=g.x+e,g.newY=g.y+t,J(g,e,t)?(q+=g.x-g.newX,W+=g.y-g.newY,g.x=g.newX,g.y=g.newY):(g.x+=e,g.y+=t,q-=e,W-=t),z(g)},X=()=>{s.rects.forEach((e=>{l(e.x+q,e.y+W,e.width,e.height,d,e.color,!0)})),s.specialObjects.forEach((e=>{"fire"!=e.id&&d.drawImage(y[e.id],e.x+q,e.y+W)}))},Y=()=>{i.clearRect(0,0,j,_),l(0,0,f,R,i,"white",!0),L+=0,m.forEach((function(e){e.hSpeed=1*Math.cos(L),e.vSpeed=1*Math.sin(L),e.x+=e.hSpeed,e.y+=e.vSpeed,e.x>f+20?e.x=-20:e.x<-20&&(e.x=f+20),e.y>R+20?e.y=-20:e.y<-20&&(e.y=R+20),l(e.x,e.y,e.width,e.height,i,e.color,!0)})),s.specialObjects.forEach((e=>{"fire"==e.id&&((e,t,a,n,l)=>{l.save();for(let p=0;p<100;p++){l.beginPath(),l.lineWidth=10;var s=parseInt(Math.random()*a,10),r=parseInt(Math.random()*(n-100),10)+50,o=parseInt(Math.random()*(n-100),10)+50,d=c(100,255),i=c(0,200),m=c(0,230);l.moveTo(e+s,t+r);var u="rgb("+d+","+i+","+m+")";l.strokeStyle=u,l.lineTo(e+s,t+o),l.stroke()}l.restore()})(e.x+q,e.y+W,e.width,e.height,i)}))},U=async()=>{u&&!C&&(console.log(socket),socket.emit("sendMovement",u),h=0,u.movement=[])},G=()=>{if(C)return;let e;u.movement.push({x:g.x+g.halfWidth,y:g.y+g.halfHeight,flipped:g.flip}),p&&(e=Object.keys(p),e.splice(e.indexOf(g.name),1),e.length<1||(o.clearRect(0,0,j,_),e.forEach((e=>{const t=p[e].movement[h];t&&n(t.x+q-1.5,t.y+W-7,o,t.flipped,1,`${p[e].color}55`,!1)})),h+=1))},J=(e,t,a)=>{let n=!1;return s.rects.forEach((l=>{V(e,l)&&(n=!0,(((e,t)=>e.y+(e.halfHeight-2)<t.y&&e.newY+(e.halfHeight+2)>=t.y)(e,l)||((e,t)=>e.y-(e.halfHeight-2)>=t.y+t.height&&e.newY-(e.halfHeight+2)<t.y+t.height)(e,l))&&(e.newY-=a,B||(x=!0)),(((e,t)=>e.x-(e.halfWidth-2)>=t.x+t.width&&e.newX-(e.halfWidth+2)<t.x+t.width)(e,l)||((e,t)=>e.x+(e.halfWidth-2)<=t.x&&e.newX+(e.halfWidth+2)>=t.x)(e,l))&&(e.newX-=t))})),n},V=(e,t)=>e.newX-e.halfWidth<t.x+t.width&&e.newX+e.halfWidth>t.x&&e.newY-e.halfHeight<t.y+t.height&&e.newY+e.halfHeight>t.y,z=e=>{s.specialObjects.forEach((t=>{if(V(e,t))if("fire"!==t.id)s.specialObjects.splice(s.specialObjects.indexOf(t),1),E[t.id].collected();else{O=!1,k.play();const e=g.color;g.color="red",setTimeout((t=>{O=!0,te(),g.color=e}),500)}}))},K=e=>{y.screwattack=document.getElementById("screwattack"),y.morphball=document.getElementById("morphball"),y.yellowswitch=document.getElementById("yellowswitch"),!0===e.morphball&&Z(!1),!0===e.screwattack&&ee(!1)},Q=(e=0)=>{g.shape=e};function Z(e=!0){document.getElementById("morphball").style.display="inline",document.getElementById("moveInstructions").innerHTML="Use '<strong>A</strong>', '<strong>D</strong>', and '<strong>W</strong>' to move, ",T=!0,F=!0,!0===e&&(r(g.name,"morphball"),v.play())}function ee(e=!0){document.getElementById("screwattack").style.display="inline",document.getElementById("spaceInstructions").innerHTML="<strong>&nbsp;SPACE</strong> to ultra flip",B=!0,!0===e&&(r(g.name,"screwattack"),v.play())}const te=()=>{g.x=300,g.y=300,g.flip=!1,g.newX=300,g.newY=300,q=0,W=0};function ae(){C||(m.push(new s.bgRect(Math.random()*j,Math.random()*_,10*Math.random()+30,4*Math.random()+3,I)),(async(e="#000000")=>{const t={color:e,_csrf:document.querySelector("#_csrf").value};await fetch("/addCloud",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t)})})(I),b.pause(),P.play(),document.getElementById("resetBtn").disabled=!0,setTimeout((()=>{S.play(),S.addEventListener("timeupdate",(e=>{S.currentTime>S.duration-.12&&(S.currentTime=0,S.play())}))}),4e3),C=!0),M<254&&(M+=.2,g.y+=.5),n(g.x+q,g.y+W,d,g.flip,g.scale,`#000000${(255-M).toString(16).substring(0,2)}`,void 0,g.shape),m.forEach((e=>{m.indexOf(e)!=m.length-1?e.color=`rgba(${M}, ${M}, ${M}, 0.1)`:e.color=`${I}${M.toString(16).substring(0,2)}`})),s.rects.forEach((e=>{e.color=`rgba(${M}, ${M}, ${M}, 0.5)`}))}const ne=()=>{socket.on("receiveMovement",(e=>{console.log(e),p=e}))},le=e=>{if(e.target==document.body)switch(e.keyCode){case 65:case 68:D[e.keyCode]=!0;break;case 87:T&&(D[e.keyCode]=!0);break;case 32:e.preventDefault(),D[e.keyCode]||(x||B)&&(g.flip=!g.flip,x=!1),D[e.keyCode]=!0}},ce=e=>{if(e.target==document.body)switch(e.keyCode){case 65:case 68:case 87:case 32:D[e.keyCode]=!1}}}},t={};function a(n){var l=t[n];if(void 0!==l)return l.exports;var c=t[n]={exports:{}};return e[n](c,c.exports,a),c.exports}a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{const e=a(603),t=a(689),n=a(802),l=a(264),c=t=>{t.preventDefault(),e.hideError();const a=t.target.querySelector("#user").value,n=t.target.querySelector("#pass").value,l=document.querySelector("#_csrf").value;return a&&n?(e.sendPost(t.target.action,{username:a,pass:n,_csrf:l},u),!1):(e.handleError("Username or password is empty!"),!1)},s=t=>{t.preventDefault(),e.hideError();const a=t.target.querySelector("#user").value,n=t.target.querySelector("#pass").value,l=t.target.querySelector("#pass2").value,c=t.target.querySelector("#colorField").value,s=document.querySelector("#_csrf").value;return a&&n&&l?n!==l?(e.handleError("Passwords do not match!"),!1):(e.sendPost(t.target.action,{username:a,pass:n,pass2:l,color:c,_csrf:s},u),!1):(e.handleError("All fields are required!"),!1)},r=t=>{t.preventDefault(),e.hideError();const a=t.target.querySelector("#oldPass").value,n=t.target.querySelector("#newPass").value,l=document.querySelector("#_csrf").value;return a&&n?a===n?(e.handleError("The two passwords are the same!"),!1):(e.sendPost(t.target.action,{oldPass:a,newPass:n,_csrf:l},o),!1):(e.handleError("One or more password fields are empty!"),!1)},o=e=>{e.message&&(document.getElementById("oldPass").value="",document.getElementById("newPass").value="")},d=e=>React.createElement("form",{id:"loginForm",name:"loginForm",onSubmit:c,action:"/login",method:"POST",className:"inputForm"},React.createElement("div",{className:"floatLeft"},React.createElement("label",{htmlFor:"username"},"Username: "),React.createElement("input",{id:"user",type:"text",name:"username",placeholder:"username"})),React.createElement("div",{className:"floatRight"},React.createElement("label",{htmlFor:"pass"},"Password: "),React.createElement("input",{id:"pass",type:"password",name:"pass",placeholder:"password"})),React.createElement("input",{className:"formSubmit",type:"submit",value:"Log in"})),i=e=>React.createElement("form",{id:"signupForm",name:"signupForm",onSubmit:s,action:"/signup",method:"POST",className:"inputForm"},React.createElement("div",{className:"floatLeft"},React.createElement("label",{htmlFor:"username"},"Username: "),React.createElement("input",{id:"user",type:"text",name:"username",placeholder:"username"})),React.createElement("div",{className:"floatRight"},React.createElement("label",{htmlFor:"pass"},"Password: "),React.createElement("input",{id:"pass",type:"password",name:"pass",placeholder:"password"})),React.createElement("div",{className:"floatLeft"},React.createElement("label",{htmlFor:"colorField"},"Color: "),React.createElement("input",{id:"colorField",type:"color",name:"color",defaultValue:"#6495ed"})),React.createElement("div",{className:"floatRight"},React.createElement("label",{htmlFor:"pass2"},"Password: "),React.createElement("input",{id:"pass2",type:"password",name:"pass2",placeholder:"password"})),React.createElement("input",{className:"formSubmit",type:"submit",value:"Create Account"})),m=e=>{const[t,a]=React.useState(e.displayMode);return React.useEffect((async()=>{a(e.displayMode)}),[e]),0===t?null:React.createElement("form",{id:"changePasswordForm",name:"changePasswordForm",onSubmit:r,action:"/changePassword",method:"POST",className:"inputForm"},React.createElement("div",{className:"floatLeft"},React.createElement("label",{htmlFor:"oldPass"},"Current Password: "),React.createElement("input",{id:"oldPass",type:"password",name:"oldPass",placeholder:"password"})),React.createElement("div",{className:"floatRight"},React.createElement("label",{htmlFor:"newPass"},"New Password: "),React.createElement("input",{id:"newPass",type:"password",name:"newPass",placeholder:"password"})),React.createElement("button",{type:"button",id:"closeForm",onClick:e=>{a(0)}},"Close Form"),React.createElement("input",{className:"formSubmit",id:"changePasswordSubmit",type:"submit",value:"Set Password"}))},u=(e,t)=>(n.init(e,t),ReactDOM.render(React.createElement(l.PayModelDisplay,{displayMode:0,disabled:!1,selected:e.shape}),document.getElementById("payModel")),document.getElementById("createResponse").textContent="Logged in as "+e.username,document.getElementById("resetBtn").disabled=!1,document.getElementById("loginButton").classList.add("hidden"),document.getElementById("signupButton").classList.add("hidden"),document.getElementById("changePasswordButton").classList.remove("hidden"),document.getElementById("logoutLink").classList.remove("hidden"),ReactDOM.render(null,document.getElementById("formContent")),!1);window.onload=async()=>{t.getData();const e=await fetch("/init"),a=await e.json();l.init();const n=document.getElementById("loginButton"),c=document.getElementById("signupButton"),s=document.getElementById("changePasswordButton");document.getElementById("_csrf").value=a.csrfToken,s.addEventListener("click",(e=>(e.preventDefault(),ReactDOM.render(React.createElement(m,{displayMode:1}),document.getElementById("formContent")),c.disabled=!1,n.disabled=!0,!1))),a.account?(u(a.account,!0),document.getElementById("createResponse").textContent="Logged in as "+a.account.username):(n.addEventListener("click",(e=>(e.preventDefault(),ReactDOM.render(React.createElement(d,null),document.getElementById("formContent")),c.disabled=!1,n.disabled=!0,!1))),c.addEventListener("click",(e=>(e.preventDefault(),ReactDOM.render(React.createElement(i,null),document.getElementById("formContent")),n.disabled=!1,c.disabled=!0,!1))),ReactDOM.render(React.createElement(i,null),document.getElementById("formContent")))}})()})();